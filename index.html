<!DOCTYPE html>
<html>
    <head>
        <script type="module">
            import data from "./months.json" assert { type: "json" };

            function generateDate() {
                const d = new Date();

                function isLeapYear() {
                    const year = d.getFullYear();
                    if (year % 400 === 0) return true;
                    if (year % 100 === 0) return false;
                    return year % 4 === 0;
                }
                function findDayOfYear(month) {
                    let res = d.getDate();
                    while (month > 0) {
                        month--;
                        res += data[month][1];
                        if (isLeapYear() && month === 2) res++;
                    }
                    return res;
                }
                /*
                the plan:
                - find day relative to month
                - generate random year
                - find day relative to year
                */
                // find day of the year
                const curMonth = d.getMonth();
                let dayOfYear = findDayOfYear(curMonth);

                // generate a random month to be displayed
                let randomMonth = Math.floor(Math.random() * 12);
                // calculate day of the month relative to that month
                let dayOfMonth = dayOfYear - findDayOfYear(randomMonth) + d.getDate();
                
                document.getElementById("date").textContent = `Today is ${data[randomMonth][0]} ${dayOfMonth}`;
            }
            addEventListener("load", generateDate);
        </script>
    </head>
    <body>
        <h1 id="date" style="height: 100%; font-family: 'Courier New', Courier, monospace; font-size: 100px; text-align: center;">Sorry, an error has occurred.</h1>
    </body>
</html>